<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Python Versions and Virtual Environments</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="/static/main.css" />
</head>
<body>
<div id="preamble" class="status">
<nav id="navbar" class="cf">
  <ul class="cf">
    <li class="fl">
      <a href="/">cfclrk</a>
    </li>
    <li class="fr">
      <a href="/articles/home.html">Articles</a>
    </li>
    <li class="fr">
      <a href="/notes/home.html">Notes</a>
    </li>
	<li class="fr">
      <a href="/cloudformation/home.html">CloudFormation</a>
    </li>
  </ul>
</nav>
</div>
<div id="content">
<header>
<h1 class="title">Python Versions and Virtual Environments</h1>
</header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgce64773">1. The Problem</a></li>
<li><a href="#org0a31dcb">2. Quick and Dirty Solution: <code>python3</code></a></li>
<li><a href="#org15f8c6a">3. The Real Solution: <code>pyenv</code></a>
<ul>
<li><a href="#org4955d43">Install pyenv</a></li>
<li><a href="#orgbeb1a56">Try out <code>pyenv</code></a></li>
<li><a href="#org620bdfd">Two <code>pyenv</code> Workflows</a>
<ul>
<li><a href="#orgf2a0d14">Option 1: The Easy Way. Just use <code>pyenv global</code>.</a></li>
<li><a href="#org0584bda">Option 2: The Pythonista. Use <code>pyenv virtualenv</code>.</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org4ad8078">New notes</a></li>
</ul>
</div>
</nav>

<div id="outline-container-orgce64773" class="outline-2">
<h2 id="orgce64773"><a href="#orgce64773">1. The Problem</a></h2>
<div class="outline-text-2" id="text-orgce64773">
<p>
Your computer (probably) comes with a version of Python preinstalled, but you
want to have several versions of Python installed and easily switch between
them.
</p>

<p>
Note on your system python: Do not try to eradicate your system's default
Python installation, even (especially) if it is Python 2. Apparently many OS
distributions still leverage arcane Python 2 programs, so if you were to
remove Python 2 completely your computer would cry battery acid and explode.
</p>

<p>
In my opinion, the best solution on Linux/MacOS is to use <code>pyenv</code> to install
multiple Python versions, and Python's built-in <code>venv</code> to manage virtual
environments.
</p>

<p>
First, a quick-and-dirty solution to provide some context.
</p>
</div>
</div>

<div id="outline-container-org0a31dcb" class="outline-2">
<h2 id="org0a31dcb"><a href="#org0a31dcb">2. Quick and Dirty Solution: <code>python3</code></a></h2>
<div class="outline-text-2" id="text-org0a31dcb">
<p>
(Don't do this, except for maybe on a CI server or to build a container).
</p>

<p>
So you'd like to install and use Python 3 but you <span class="underline">must not</span> replace or
upgrade your system's Python (for the reason mentioned above). The Python
community slithered their way around this problem with an unlikely trick: when
you install the [latest python][python] from the Python website, it actually
gets installed as a <span class="underline">new, differently-named</span> program called <code>python3</code>. So
after installing you'll notice:
</p>

<pre class="example" id="org58874e6">
$ python --version
Python 2.7.10
$ python3 --version
Python 3.5.0
</pre>

<p>
Also notice that you got a new version of pip, called <code>pip3</code>:
</p>

<pre class="example" id="org7a0cf84">
$ pip --version
pip 7.1.2 from /Library/Python/2.7/site-packages (python 2.7)
$ pip3 --version
pip 7.1.2 from /usr/local/lib/python3.5/site-packages (python 3.5)
</pre>

<p>
Now, you have to make sure to use <code>pip3</code> to install packages that will be used
by <code>python3</code>. Also not that any program that specifies <code>#!/usr/bin/env python</code>
will use ptyhon 2.
</p>

<p>
So the quick and dirty solution to using Python 3 is: download and install
<a href="https://www.python.org/downloads/">Python 3</a> from the Python website, and whenever you want to use it,
remember to run it with the <code>python3</code> command on the command line.
</p>
</div>
</div>

<div id="outline-container-org15f8c6a" class="outline-2">
<h2 id="org15f8c6a"><a href="#org15f8c6a">3. The Real Solution: <code>pyenv</code></a></h2>
<div class="outline-text-2" id="text-org15f8c6a">
<p>
Do this.
</p>

<p>
<code>pyenv</code> lets you download as many versions of Python you want, and provides a
way to easily switch between them.
</p>
</div>

<div id="outline-container-org4955d43" class="outline-3">
<h3 id="org4955d43"><a href="#org4955d43">Install pyenv</a></h3>
<div class="outline-text-3" id="text-org4955d43">
<div class="org-src-container">
<pre class="src src-sh">brew update
brew install pyenv
brew install pyenv-virtualenv
</pre>
</div>

<p>
Then add the following to your <code>~/.profile</code>:
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #c678dd;">eval</span> <span style="color: #98be65;">"$(pyenv init -)"</span>
<span style="color: #c678dd;">eval</span> <span style="color: #98be65;">"$(pyenv virtualenv-init -)"</span>
</pre>
</div>

<p>
Remember to source your <code>~/.profile</code> (or log out and log back in) for the
changes to take effect.
</p>
</div>
</div>

<div id="outline-container-orgbeb1a56" class="outline-3">
<h3 id="orgbeb1a56"><a href="#orgbeb1a56">Try out <code>pyenv</code></a></h3>
<div class="outline-text-3" id="text-orgbeb1a56">
<p>
Now you've got <code>pyenv</code>; run these commands to get a feel for it:
</p>

<pre class="example" id="org037b0fa">
$ pyenv install --list   # look at all the Python versions you can download!
$ pyenv install 2.7.11   # download python 2.7.11
$ pyenv install 3.5.0    # download python 3.5.0
$ pyenv versions         # see all the Pythons you have downloaded
$ pyenv version          # print the current python version
$ pyenv root             # that's where all those python's got downloaded
</pre>

<p>
None of these commands change the version of Python that your computer uses.
To start <i>using</i> one of the Pythons you've downloaded, pick one of two
popular workflows.
</p>
</div>
</div>

<div id="outline-container-org620bdfd" class="outline-3">
<h3 id="org620bdfd"><a href="#org620bdfd">Two <code>pyenv</code> Workflows</a></h3>
<div class="outline-text-3" id="text-org620bdfd">
<p>
There are two approaches to using <code>pyenv</code>. Option 1 is easier and totally
reasonable. Option 2 uses python virtual environments, which is a bit more
involved but provides more isolation for each project you work on.
</p>
</div>

<div id="outline-container-orgf2a0d14" class="outline-4">
<h4 id="orgf2a0d14"><a href="#orgf2a0d14">Option 1: The Easy Way. Just use <code>pyenv global</code>.</a></h4>
<div class="outline-text-4" id="text-orgf2a0d14">
<p>
Let's start using python 3. Assuming you've already downloaded python 3.5.0
by doing <code>pyenv install 3.5.0</code>, you can start using it by:
</p>

<p>
$ pyenv global 3.5.0
$ pyenv version          # says 3.5.0
$ python &#x2013;version       # also says 3.5.0
</p>

<p>
Bam! Now Python 3 is your default Python. Now run whatever python 3 program
you want.
</p>

<p>
Now, say you need to run a python 2 program.
</p>

<div class="org-src-container">
<pre class="src src-sh">pyenv global 2.7.11
</pre>
</div>

<p>
There's even a productivity-boosting shortcut you can use: if a particular
project uses <code>2.7.11</code>, you can <code>cd</code> into that project and say
</p>

<p>
$ pyenv local 2.7.11
</p>

<p>
A little file gets created in that directory called <code>.python-version</code>, and
it just says <code>2.7.11</code>. From now on, every time you <code>cd</code> into that directory,
<code>pyenv</code> will <i>automatically</i> switch to <code>2.7.11</code>. Seriously, it's some
next-level stuff.
</p>
</div>
</div>

<div id="outline-container-org0584bda" class="outline-4">
<h4 id="org0584bda"><a href="#org0584bda">Option 2: The Pythonista. Use <code>pyenv virtualenv</code>.</a></h4>
<div class="outline-text-4" id="text-org0584bda">
<p>
The Pythonista makes a habit of using a separate Python virtual environment
for every project. This helps to ensure that you specify your dependencies
correctly in every project. If you have two projects, "fooproject" and
"barproject", and each uses python 3.5.0, you can set up a virtual
environment for each one like this:
</p>

<p>
$ cd /path/to/fooproject
$ pyenv virtualenv 3.5.0 fooproj
$ pyenv local fooproj
</p>

<p>
$ cd /path/to/barproject
$ pyenv virtualenv 3.5.0 barproj
$ pyenv local barproj
</p>

<p>
Each time you <code>cd</code> into one of those projects, <code>pyenv</code> activates the correct
virtual environment (there's no magic to this, <code>pyenv</code> just notices there's a
<code>.python-version</code> file in the project and activates whatever is specified in
that file). Each virtual environment only starts off with 2 packages, <code>pip</code> and
<code>setuptools</code>.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org4ad8078" class="outline-2">
<h2 id="org4ad8078"><a href="#org4ad8078">New notes</a></h2>
<div class="outline-text-2" id="text-org4ad8078">
<p>
Use pyenv to download python versions
</p>

<p>
Create a pyenv virtualenv for each version?
</p>

<p>
Switch to the version of python you want to use (with pyenv)
</p>

<p>
python -m venv .venv
</p>
</div>
</div>
</div>
</body>
</html>
