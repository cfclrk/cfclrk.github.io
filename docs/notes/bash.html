<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Bash</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="/static/main.css" />
</head>
<body>
<div id="preamble" class="status">
<nav id="navbar" class="cf">
  <ul class="cf">
    <li class="fl">
      <a href="/">cfclrk</a>
    </li>
    <li class="fr">
      <a href="/articles/home.html">Articles</a>
    </li>
    <li class="fr">
      <a href="/notes/home.html">Notes</a>
    </li>
	<li class="fr">
      <a href="/cloudformation/home.html">CloudFormation</a>
    </li>
  </ul>
</nav>
</div>
<div id="content" class="content">
<header>
<h1 class="title">Bash</h1>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgd1fcdc9">Style</a></li>
<li><a href="#orgfebc29c">Function Parameters</a>
<ul>
<li><a href="#org7242c43">Using [[ (new-test)</a></li>
<li><a href="#org2260404">Using test</a></li>
<li><a href="#org32e7e34">if-else</a></li>
</ul>
</li>
<li><a href="#org9c01c16">Set</a>
<ul>
<li><a href="#org675305a">set -u</a></li>
</ul>
</li>
<li><a href="#org11e501d">Script Arguments</a></li>
<li><a href="#orgfb7e0a7">Script Options</a>
<ul>
<li><a href="#orgb007dd9">getopts</a></li>
</ul>
</li>
<li><a href="#org6fc18a0">Heredocs</a>
<ul>
<li><a href="#orgd952d71">Whitespace</a></li>
<li><a href="#orge76c484">Interpolation</a>
<ul>
<li><a href="#org2a606d4">with interpolation</a></li>
<li><a href="#org149d7e5">without interpolation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgf9ab960">Verify Environment Variables</a></li>
<li><a href="#org740f970">Parameter Expansion</a>
<ul>
<li><a href="#orgff920fa">Resources</a></li>
<li><a href="#orgcb371de">:-</a></li>
<li><a href="#org100fa70">+</a></li>
</ul>
</li>
<li><a href="#orgdb0d8df">Arrays</a>
<ul>
<li><a href="#orgdd98379">* vs @</a></li>
<li><a href="#org5da2684">Basic</a></li>
<li><a href="#org9f2cb4c">Length</a></li>
<li><a href="#orgda3a03a">Pipe array to xargs</a></li>
</ul>
</li>
<li><a href="#org614c5a6">Range</a></li>
<li><a href="#orge0d98bc">Strings, Echo, and Printf</a>
<ul>
<li><a href="#org778d8cc">Echo adds a newline</a></li>
<li><a href="#org4d282d2">Print a multiline string</a></li>
</ul>
</li>
<li><a href="#org96b72a9">Numbered List</a></li>
</ul>
</div>
</nav>

<div id="outline-container-orgd1fcdc9" class="outline-2">
<h2 id="orgd1fcdc9"><a href="#orgd1fcdc9">Style</a></h2>
<div class="outline-text-2" id="text-orgd1fcdc9">
<ul class="org-ul">
<li><p>
Google <a href="https://google.github.io/styleguide/shellguide.html">Shell Style Guide</a>
</p>

<p>
Interestingly, says to use <code>#!/bin/bash</code>.
</p></li>

<li><p>
<a href="https://github.com/azet/community_bash_style_guide">Community Bash Style Guide</a>
</p>

<p>
One person's opinions, but I like them.
</p></li>
</ul>
</div>
</div>

<div id="outline-container-orgfebc29c" class="outline-2">
<h2 id="orgfebc29c"><a href="#orgfebc29c">Function Parameters</a></h2>
<div class="outline-text-2" id="text-orgfebc29c">
<p>
How to specify bash functions with required parameters. When the function is
applied to the wrong number of arguments, a non-0 exit status should be
returned.
</p>
</div>

<div id="outline-container-org7242c43" class="outline-3">
<h3 id="org7242c43"><a href="#org7242c43">Using [[ (new-test)</a></h3>
<div class="outline-text-3" id="text-org7242c43">
<p>
The double-bracket <code>[[</code> syntax is called "new-test".
</p>

<p>
<code>-n</code> is a string comparison operator that tests if a string is not null zero-length.
</p>

<div class="org-src-container">
<pre class="src src-sh" id="org23a7fd7"><span style="color: #c678dd;">foo</span>() {
    [[ -n <span style="color: #98be65;">"$1"</span> ]] || {
        <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"Error: param 1 is required"</span>
        <span style="color: #51afef;">return</span> 1
    }
    <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"Param is: $1"</span>
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #c678dd;">foo</span>() {
    [[ -n <span style="color: #98be65;">"$1"</span> ]] || {
        <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"Error: param 1 is required"</span>
        <span style="color: #51afef;">return</span> 1
    }
    <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"Param is: $1"</span>
}
foo
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
Error: param 1 is required
</pre>


<div class="org-src-container">
<pre class="src src-sh"><span style="color: #c678dd;">foo</span>() {
    [[ -n <span style="color: #98be65;">"$1"</span> ]] || {
        <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"Error: param 1 is required"</span>
        <span style="color: #51afef;">return</span> 1
    }
    <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"Param is: $1"</span>
}
foo <span style="color: #98be65;">""</span>
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
Error: param 1 is required
</pre>


<div class="org-src-container">
<pre class="src src-sh"><span style="color: #c678dd;">foo</span>() {
    [[ -n <span style="color: #98be65;">"$1"</span> ]] || {
        <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"Error: param 1 is required"</span>
        <span style="color: #51afef;">return</span> 1
    }
    <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"Param is: $1"</span>
}
foo bar
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
Param is: bar
</pre>
</div>
</div>

<div id="outline-container-org2260404" class="outline-3">
<h3 id="org2260404"><a href="#org2260404">Using test</a></h3>
<div class="outline-text-3" id="text-org2260404">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #c678dd;">foo</span>() {
    [ -n <span style="color: #98be65;">"$1"</span> ] || {
        <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"Error: param 1 is required"</span>
        <span style="color: #51afef;">return</span> 1
    }
}
</pre>
</div>

<p>
Note that <code>[</code> <code>]</code> is an alias for <code>test</code>. For completeness, the above example
can be written as:
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #c678dd;">foo</span>() {
    <span style="color: #dcaeea;">a</span>=${<span style="color: #dcaeea;">1</span>-}
    <span style="color: #c678dd;">test</span> -n <span style="color: #98be65;">"$a"</span> || {
        <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"Error: a is required"</span>
        <span style="color: #51afef;">return</span> 1
    }
}
</pre>
</div>

<p>
For more info, see <a href="http://mywiki.wooledge.org/BashFAQ/031">FAQ</a>: "What is the difference between <code>test</code>, <code>[</code> and <code>[[</code>?"
</p>
</div>
</div>

<div id="outline-container-org32e7e34" class="outline-3">
<h3 id="org32e7e34"><a href="#org32e7e34">if-else</a></h3>
<div class="outline-text-3" id="text-org32e7e34">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #c678dd;">func</span>() {
    <span style="color: #51afef;">if</span> [ -z ${<span style="color: #dcaeea;">1</span>+x} ]; <span style="color: #51afef;">then</span>
        <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"Error: param 1 is required"</span>
        <span style="color: #51afef;">return</span> 1
    <span style="color: #51afef;">else</span>
        local <span style="color: #dcaeea;">a</span>=$<span style="color: #dcaeea;">1</span>
    <span style="color: #51afef;">fi</span>
    <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"a is '$a'"</span>
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org9c01c16" class="outline-2">
<h2 id="org9c01c16"><a href="#org9c01c16">Set</a></h2>
<div class="outline-text-2" id="text-org9c01c16">
</div>
<div id="outline-container-org675305a" class="outline-3">
<h3 id="org675305a"><a href="#org675305a">set -u</a></h3>
<div class="outline-text-3" id="text-org675305a">
<p>
Without <code>set -u</code> this works fine and prints nothing, even though <code>foo</code> is not
bound.
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #c678dd;">echo</span> $<span style="color: #dcaeea;">foo</span>
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">

</pre>


<p>
This produces an error: "bash: line 2: foo: unbound variable" (TODO: org mode
to print this).
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #c678dd;">set</span> -u
<span style="color: #c678dd;">echo</span> $<span style="color: #dcaeea;">foo</span>
</pre>
</div>

<p>
Works with <code>eval</code>.
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #c678dd;">set</span> -u
<span style="color: #dcaeea;">vars</span>=<span style="color: #98be65;">"FOO=foo BAR=bar"</span>
<span style="color: #c678dd;">eval</span> $<span style="color: #dcaeea;">vars</span>
<span style="color: #c678dd;">echo</span> $<span style="color: #dcaeea;">FOO</span>
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
foo
</pre>
</div>
</div>
</div>

<div id="outline-container-org11e501d" class="outline-2">
<h2 id="org11e501d"><a href="#org11e501d">Script Arguments</a></h2>
<div class="outline-text-2" id="text-org11e501d">
<p>
Same patterns as function parameters can be used.
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #51afef;">if</span> [ -z ${<span style="color: #dcaeea;">1</span>+x} ]; <span style="color: #51afef;">then</span>
    <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"arg 1 (foo) is required"</span>
    <span style="color: #51afef;">exit</span> 1
<span style="color: #51afef;">fi</span>
<span style="color: #dcaeea;">foo</span>=$<span style="color: #dcaeea;">1</span>
<span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"foo is: '$foo'"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfb7e0a7" class="outline-2">
<h2 id="orgfb7e0a7"><a href="#orgfb7e0a7">Script Options</a></h2>
<div class="outline-text-2" id="text-orgfb7e0a7">
</div>
<div id="outline-container-orgb007dd9" class="outline-3">
<h3 id="orgb007dd9"><a href="#orgb007dd9">getopts</a></h3>
<div class="outline-text-3" id="text-orgb007dd9">
<p>
See home/bin/ssm script for a good example.
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #c678dd;">showHelp</span>() {
    cat &lt;&lt;END
<span style="color: #98be65;">Usage: $(basename "$0") [-p profile]</span>
<span style="color: #98be65;">END</span>
}

<span style="color: #51afef;">while </span><span style="color: #c678dd;">getopts</span> :hp: arg; <span style="color: #51afef;">do</span>
    <span style="color: #51afef;">case</span> ${<span style="color: #dcaeea;">arg</span>} <span style="color: #51afef;">in</span>
        h)
            showHelp
            <span style="color: #51afef;">exit</span> 0
            ;;
        p)
            <span style="color: #dcaeea;">profile</span>=<span style="color: #98be65;">"$OPTARG"</span>
            ;;
        <span style="color: #98be65;">\?</span>)
            <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"Invalid option: -$OPTARG"</span> &gt;&amp;2
            <span style="color: #51afef;">exit</span> 1
            ;;
        :)
            <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"Option -$OPTARG requires an argument"</span> &gt;&amp;2
            <span style="color: #51afef;">exit</span> 1
            ;;
    <span style="color: #51afef;">esac</span>
<span style="color: #51afef;">done</span>
<span style="color: #c678dd;">shift</span> $((OPTIND -1))

<span style="color: #5B6268;"># </span><span style="color: #5B6268;">Define default option values</span>
<span style="color: #dcaeea;">profile</span>=${<span style="color: #dcaeea;">profile</span>:=<span style="color: #98be65;">"chrisc"</span>}

<span style="color: #dcaeea;">aws</span>=<span style="color: #98be65;">"aws --profile $profile --region us-east-1"</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org6fc18a0" class="outline-2">
<h2 id="org6fc18a0"><a href="#org6fc18a0">Heredocs</a></h2>
<div class="outline-text-2" id="text-org6fc18a0">
</div>
<div id="outline-container-orgd952d71" class="outline-3">
<h3 id="orgd952d71"><a href="#orgd952d71">Whitespace</a></h3>
<div class="outline-text-3" id="text-orgd952d71">
<p>
Use <code>&lt;&lt;-</code>. Each line in the HEREDOC has to begin with a TAB. Having trouble
getting this working with org-babel.
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #dcaeea;">foo</span>=<span style="color: #98be65;">"bar"</span>
<span style="color: #dcaeea;">a</span>=$(cat &lt;&lt;-EOF
<span style="color: #98be65;">hello</span>
<span style="color: #98be65;">$foo</span>
<span style="color: #98be65;">EOF</span>
)
<span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"$a"</span>
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
hello
bar
EOF
</pre>
</div>
</div>

<div id="outline-container-orge76c484" class="outline-3">
<h3 id="orge76c484"><a href="#orge76c484">Interpolation</a></h3>
<div class="outline-text-3" id="text-orge76c484">
<p>
A heredoc can interpolate variable names to values, or the whole heredoc can
be taken completely literally without any interpolation. The difference is
whether the limit string has single quotes around it.
</p>
</div>

<div id="outline-container-org2a606d4" class="outline-4">
<h4 id="org2a606d4"><a href="#org2a606d4">with interpolation</a></h4>
<div class="outline-text-4" id="text-org2a606d4">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #dcaeea;">foo</span>=<span style="color: #98be65;">"fooo"</span>
<span style="color: #dcaeea;">a</span>=$(cat &lt;&lt;EOF
<span style="color: #98be65;">hello</span>
<span style="color: #98be65;">$foo</span>
<span style="color: #98be65;">EOF</span>
)
<span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"$a"</span>
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
hello
fooo
</pre>


<p>
Note, this also works with single quotes!
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #dcaeea;">foo</span>=<span style="color: #98be65;">"fooo"</span>
<span style="color: #dcaeea;">a</span>=$(cat &lt;&lt;EOF
<span style="color: #98be65;">hello</span>
<span style="color: #98be65;">'$foo'</span>
<span style="color: #98be65;">EOF</span>
)
<span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"$a"</span>
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
hello
'fooo'
</pre>
</div>
</div>

<div id="outline-container-org149d7e5" class="outline-4">
<h4 id="org149d7e5"><a href="#org149d7e5">without interpolation</a></h4>
<div class="outline-text-4" id="text-org149d7e5">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #dcaeea;">foo</span>=<span style="color: #98be65;">"bar"</span>
<span style="color: #dcaeea;">a</span>=$(cat &lt;&lt;<span style="color: #98be65;">'EOF'</span>
<span style="color: #98be65;">hello</span>
<span style="color: #98be65;">$foo</span>
<span style="color: #98be65;">EOF</span>
)
<span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"$a"</span>
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
hello
$foo
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf9ab960" class="outline-2">
<h2 id="orgf9ab960"><a href="#orgf9ab960">Verify Environment Variables</a></h2>
<div class="outline-text-2" id="text-orgf9ab960">
<p>
Verify some environment variables exist.
</p>

<div class="org-src-container">
<pre class="src src-sh">: <span style="color: #98be65;">"${FOO:?FOO is not set}"</span>
: <span style="color: #98be65;">"${BAR:?BAR is not set}"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org740f970" class="outline-2">
<h2 id="org740f970"><a href="#org740f970">Parameter Expansion</a></h2>
<div class="outline-text-2" id="text-org740f970">
</div>
<div id="outline-container-orgff920fa" class="outline-3">
<h3 id="orgff920fa"><a href="#orgff920fa">Resources</a></h3>
<div class="outline-text-3" id="text-orgff920fa">
<ul class="org-ul">
<li>GNU <a href="https://www.gnu.org/savannah-checkouts/gnu/bash/manual/">Bash docs</a> section on <a href="https://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion">paremeter expansion</a></li>
<li><i>The Open Group</i> has some excellent <a href="https://pubs.opengroup.org/onlinepubs/9699919799">POSIX documentation</a> with a section on
<a href="http://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_06_02">parameter expansion</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgcb371de" class="outline-3">
<h3 id="orgcb371de"><a href="#orgcb371de">:-</a></h3>
<div class="outline-text-3" id="text-orgcb371de">
<p>
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_06_02">Docs</a> for <code>${parameter:-[word]}</code>
</p>

<blockquote>
<p>
If <i>parameter</i> is unset or null, the expansion of <i>word</i> (or an empty string
if <i>word</i> is omitted) shall be substituted; otherwise, the value of
<i>parameter</i> shall be substituted.
</p>
</blockquote>

<div class="org-src-container">
<pre class="src src-bash"><span style="color: #dcaeea;">var</span>=<span style="color: #98be65;">""</span>
<span style="color: #51afef;">if</span> [ -z ${<span style="color: #dcaeea;">var</span>:-x<span style="color: #98be65;">"} ]; then</span>
<span style="color: #98be65;">    echo "</span>var is unset<span style="color: #98be65;">"</span>
<span style="color: #98be65;">else</span>
<span style="color: #98be65;">    echo "</span>var is set to <span style="color: #98be65;">'$var'"</span>
<span style="color: #98be65;">fi</span>
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
var is set to ''
</pre>


<div class="org-src-container">
<pre class="src src-sh"><span style="color: #51afef;">if</span> [ -z ${<span style="color: #dcaeea;">var</span>:-<span style="color: #98be65;">"foo"</span>} ]; <span style="color: #51afef;">then</span>
    <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"var is unset"</span>
<span style="color: #51afef;">else</span>
    <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"var is set to '$var'"</span>
<span style="color: #51afef;">fi</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org100fa70" class="outline-3">
<h3 id="org100fa70"><a href="#org100fa70">+</a></h3>
<div class="outline-text-3" id="text-org100fa70">
<p>
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_06_02">Docs</a> for <code>${parameter:+[word]}</code>
</p>

<blockquote>
<p>
If <i>parameter</i> is unset or null, null shall be substituted; otherwise, the
expansion of <i>word</i> (or an empty string if <i>word</i> is omitted) shall be
substituted.
</p>
</blockquote>

<p>
<code>-z</code> is a <a href="https://tldp.org/LDP/abs/html/comparison-ops.html">comparison operator</a> that tests if the argument is null or empty.
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #dcaeea;">var</span>=<span style="color: #98be65;">""</span>
<span style="color: #51afef;">if</span> [ -z ${<span style="color: #dcaeea;">var</span>+x} ]; <span style="color: #51afef;">then</span>
    <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"var is unset"</span>
<span style="color: #51afef;">else</span>
    <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"var is set to '$var'"</span>
<span style="color: #51afef;">fi</span>
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
var is set to ''
</pre>


<p>
In this case, <code>var</code> is the empty string, which is not "unset or null".
Therefore the <code>+</code> parameter expansion expands this to <code>x</code> (which passes the
<code>-z</code> check).
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #51afef;">if</span> [ -z ${<span style="color: #dcaeea;">var</span>+x} ]; <span style="color: #51afef;">then</span>
    <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"var is unset"</span>
<span style="color: #51afef;">else</span>
    <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"var is set to '$var'"</span>
<span style="color: #51afef;">fi</span>
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
var is unset
</pre>


<p>
In this case, <code>var</code> has not been declared, so it is "unset or null". The <code>+</code>
parameter expansion expands it to <code>null</code>.
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #dcaeea;">var</span>=<span style="color: #98be65;">""</span>
<span style="color: #51afef;">if</span> [ -z ${<span style="color: #dcaeea;">var</span>+} ]; <span style="color: #51afef;">then</span>
    <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"var is unset"</span>
<span style="color: #51afef;">else</span>
    <span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"var is set to '$var'"</span>
<span style="color: #51afef;">fi</span>
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
var is unset
</pre>


<p>
In this case we leave the <code>word</code> spot empty in the parameter expansion, so if
<code>var</code> is empty, it is subsituted by an empty string. Now the <code>-z</code> test sees an
empty argument, and this prints out <code>var is unset</code>.
</p>
</div>
</div>
</div>

<div id="outline-container-orgdb0d8df" class="outline-2">
<h2 id="orgdb0d8df"><a href="#orgdb0d8df">Arrays</a></h2>
<div class="outline-text-2" id="text-orgdb0d8df">
</div>
<div id="outline-container-orgdd98379" class="outline-3">
<h3 id="orgdd98379"><a href="#orgdd98379">* vs @</a></h3>
<div class="outline-text-3" id="text-orgdd98379">
<p>
See <a href="https://stackoverflow.com/a/3355375/340613">this StackOverflow answer</a>.
</p>

<blockquote>
<p>
The difference between <code>[@]</code> and <code>[*]</code>-expanded arrays in double-quotes is
that <code>"${myarray[@]}"</code> leads to each element of the array being treated as a
separate shell-word, while <code>"${myarray[*]}"</code> results in a single shell-word
with all of the elements of the array separated by spaces (or whatever the
first character of <code>IFS</code> is).
</p>

<p>
Usually, the <code>[@]</code> behavior is what you want.
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org5da2684" class="outline-3">
<h3 id="org5da2684"><a href="#org5da2684">Basic</a></h3>
<div class="outline-text-3" id="text-org5da2684">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #dcaeea;">arr</span>=(<span style="color: #98be65;">"foo"</span> <span style="color: #98be65;">"bar"</span> <span style="color: #98be65;">"baz"</span>)
<span style="color: #c678dd;">echo</span> ${<span style="color: #dcaeea;">arr</span>[@]}
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
foo bar baz
</pre>


<div class="org-src-container">
<pre class="src src-sh"><span style="color: #dcaeea;">arr</span>=(<span style="color: #98be65;">"foo"</span> <span style="color: #98be65;">"bar"</span> <span style="color: #98be65;">"baz"</span>)
<span style="color: #51afef;">for</span> x<span style="color: #51afef;"> in</span> ${<span style="color: #dcaeea;">arr</span>[@]}; <span style="color: #51afef;">do</span>
    <span style="color: #c678dd;">echo</span> $<span style="color: #dcaeea;">x</span>
<span style="color: #51afef;">done</span>
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
foo
bar
baz
</pre>
</div>
</div>

<div id="outline-container-org9f2cb4c" class="outline-3">
<h3 id="org9f2cb4c"><a href="#org9f2cb4c">Length</a></h3>
<div class="outline-text-3" id="text-org9f2cb4c">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #dcaeea;">arr</span>=(<span style="color: #98be65;">"foo"</span> <span style="color: #98be65;">"bar"</span> <span style="color: #98be65;">"baz"</span>)
<span style="color: #c678dd;">echo</span> ${#<span style="color: #dcaeea;">arr</span>[@]}
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
3
</pre>
</div>
</div>

<div id="outline-container-orgda3a03a" class="outline-3">
<h3 id="orgda3a03a"><a href="#orgda3a03a">Pipe array to xargs</a></h3>
<div class="outline-text-3" id="text-orgda3a03a">
<p>
Start a subprocess per element in an array, where each subprocess runs <code>$script</code>.
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #dcaeea;">script</span>=$(cat &lt;&lt;<span style="color: #98be65;">"EOF"</span>
<span style="color: #98be65;">echo {}</span>
<span style="color: #98be65;">EOF</span>
)
<span style="color: #dcaeea;">arr</span>=(<span style="color: #98be65;">"foo"</span> <span style="color: #98be65;">"bar"</span> <span style="color: #98be65;">"baz"</span>)
printf <span style="color: #98be65;">"%s\n"</span> <span style="color: #98be65;">"${arr[@]}"</span> <span style="color: #98be65;">\</span>
    | xargs -n 1 <span style="color: #98be65;">\</span>
            -P ${#<span style="color: #dcaeea;">arr</span>[@]} <span style="color: #98be65;">\</span>
            -I {} <span style="color: #98be65;">\</span>
            bash -c <span style="color: #98be65;">"$script"</span>
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
foo
bar
baz
</pre>
</div>
</div>
</div>

<div id="outline-container-org614c5a6" class="outline-2">
<h2 id="org614c5a6"><a href="#org614c5a6">Range</a></h2>
<div class="outline-text-2" id="text-org614c5a6">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #51afef;">for</span> i<span style="color: #51afef;"> in</span> {1..5}; <span style="color: #51afef;">do</span>
    <span style="color: #c678dd;">echo</span> $<span style="color: #dcaeea;">i</span>
<span style="color: #51afef;">done</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge0d98bc" class="outline-2">
<h2 id="orge0d98bc"><a href="#orge0d98bc">Strings, Echo, and Printf</a></h2>
<div class="outline-text-2" id="text-orge0d98bc">
</div>
<div id="outline-container-org778d8cc" class="outline-3">
<h3 id="org778d8cc"><a href="#org778d8cc">Echo adds a newline</a></h3>
<div class="outline-text-3" id="text-org778d8cc">
<p>
Notice that <code>echo</code> adds a newline.
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"foo"</span> | od -c
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
0000000    f   o   o  \n
0000004
</pre>


<p>
While <code>printf</code> does not.
</p>

<div class="org-src-container">
<pre class="src src-sh">printf <span style="color: #98be65;">"foo"</span> | od -c
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
0000000    f   o   o
0000003
</pre>
</div>
</div>

<div id="outline-container-org4d282d2" class="outline-3">
<h3 id="org4d282d2"><a href="#org4d282d2">Print a multiline string</a></h3>
<div class="outline-text-3" id="text-org4d282d2">
<p>
<code>echo $a</code> prints everything on one line, while <code>echo "$a"</code> preserves
newlines. Why is that?
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="color: #dcaeea;">a</span>=$(cat &lt;&lt;EOF
<span style="color: #98be65;">hello</span>
<span style="color: #98be65;">world</span>
<span style="color: #98be65;">EOF</span>
)
<span style="color: #c678dd;">echo</span> $<span style="color: #dcaeea;">a</span>
<span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"---"</span>
<span style="color: #c678dd;">echo</span> <span style="color: #98be65;">"$a"</span>
</pre>
</div>

<div class="results">#+RESULTS:</div><pre class="example">
hello world
---
hello
world
</pre>
</div>
</div>
</div>

<div id="outline-container-org96b72a9" class="outline-2">
<h2 id="org96b72a9"><a href="#org96b72a9">Numbered List</a></h2>
<div class="outline-text-2" id="text-org96b72a9">
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #c678dd;">echo</span> $<span style="color: #dcaeea;">PATH</span> | tr <span style="color: #98be65;">":"</span> <span style="color: #98be65;">"\n"</span> | nl
</pre>
</div>

<pre class="example" id="org8173336">
 1	/Users/chris.clark/.rbenv/shims
 2	/usr/local/Cellar/pyenv-virtualenv/1.1.5/shims
 3	/Users/chris.clark/.pyenv/shims
 4	/Users/chris.clark/go/bin
 5	/Users/chris.clark/bin
 6	/Users/chris.clark/.local/bin
 7	/Users/chris.clark/.cargo/bin
 8	/Users/chris.clark/.cabal/bin
 9	/Users/chris.clark/IronNet/bin
10	/usr/local/sbin
11	/usr/local/opt/make/libexec/gnubin
12	/usr/local/opt/texinfo/bin
13	/usr/local/opt/openjdk/bin
14	/usr/local/opt/curl/bin
15	/usr/local/opt/openssl@1.1/bin
16	/usr/local/bin
17	/usr/bin
18	/bin
19	/usr/sbin
20	/sbin
21	/Library/TeX/texbin
22	/Applications/Wireshark.app/Contents/MacOS
</pre>
</div>
</div>
</div>
</body>
</html>
